<!DOCTYPE html>
<html>
  <head>
    <!-- Niklas Buschmann 2015 MIT <http://github.com/niklasbuschmann> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    
    <meta name="description" content="Arduino library for Raspberry Pi">
    <title>PiDuino Library</title>
    <link rel="canonical" href="https://github.com/NVSL/PiDuino_Library/PiDuino_Library/page3/">
    <link href="/PiDuino_Library/main.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,200italic,300italic,400italic,600italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Gentium+Basic:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v2.7&appId=858282557637798";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    <link type="application/atom+xml" rel="alternate" href="https://github.com/PiDuino_Library/feed.xml" title="PiDuino Library" />
    
    
  </head>
  <body>
    <header>
      <h1><a href="/PiDuino_Library/">PiDuino Library</a></h1>

      <!--
      <ul class="title-ul">

        <li class="title-li">
        <h1><a href="/PiDuino_Library/">PiDuino Library</a></h1>
        </li>
      
        <li>
          
          <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
          <input type="hidden" name="cmd" value="_s-xclick">
          <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
          ">
          <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
          <img alt="" border="0" src="https://www.paypalobjects.com/es_XC/i/scr/pixel.gif" width="1" height="1">
          </form>
        </li>

      </ul>
      -->
      <nav>
        <ul>
          <li><a href="/PiDuino_Library/">Home</a></li>
          
          <li><a href="/PiDuino_Library/RPi_Pinout.html">RPi_Pinout</a></li>
          
          <li><a href="/PiDuino_Library/Reference.html">Reference</a></li>
          
        </ul>
      </nav>
    </header>
    
    
    <article>
        
      <article>
        <!-- <div class="fb-like" data-share="true" data-width="450" data-height="0" data-show-faces="false" data-colorscheme="dark"></div> -->
        <div align="right">
          <!--
          <div  class="fb-like"  data-href="http://nvsl.github.io/PiDuino_Library/" data-layout="button_count" 
          data-action="like" data-size="large" data-show-faces="true" data-share="true"></div>
          -->
          <div class="fb-like" data-href="http://nvsl.github.io/PiDuino_Library/" data-layout="standard" 
          data-action="like" data-size="large" data-show-faces="true" data-share="true"></div>
        </div>
        <header>
          <!-- <h2>Piduino Library (libpiduino)</h2> -->
        </header>
        <div>
  <p><strong>About</strong></p>

<p><strong>Piduino Library (libpiduino)</strong> is a C++ library that lets you write and compile Arduino programs in the Raspberry Pi. This library 
targets the BCM283x SoC (System on a Chip), all 54 pins, and not a specific set of pins of any Raspberry Pi (RPi) board.</p>

<p>This library <strong>does not support Analog to Digital Conversion (ADC)</strong> functions as the BCM283x
SoC does not have an integrated ADC and I don’t want to create hardware-dependent software. 
If you need ADC is recommended to use external libraries.</p>

<p>Finally most of this library code was built so it can be easily ported to another platform like the Artik/Exynos SoCs
 or Snapdragon SoCs in the future, if you want to port this library to another platform send me an email.</p>

<p><strong>Install</strong></p>

<p>Open a terminal in your Raspberry Pi board and enter:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install libpiduino-dev
</code></pre>
</div>
<p style="text-align: right;">-&gt; <a href="https://github.com/NVSL/PiDuino_Library">source code</a> &lt;-</p>

<p><strong>Setup</strong></p>

<p>To run this library correctly first setup the SPI, I2C and Serial Interfaces. To do this type:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo raspi-config
</code></pre>
</div>

<p>Go to Advanced options.</p>

<p><img src="images/rpi_config_1.png" alt="rpi-advanced-options" class="center-image" /></p>

<p>Enable SPI and I2C Interfaces and disable Serial login shell.</p>

<p><img src="images/rpi_config_2.png" alt="rpi-enable-interfaces" class="center-image" /></p>

<ul>
  <li>Enable SPI Interface:    YES -&gt; OK -&gt; YES -&gt; OK</li>
  <li>Enable I2C Interface:    YES -&gt; OK -&gt; YES -&gt; OK</li>
  <li>Dsiable Serial login shell:    NO -&gt; OK</li>
</ul>

<p>Reboot your system.</p>

<p><strong>Run</strong></p>

<p>Once the setup is complete create a file, lets say test.cpp, and copy the following code:</p>

<p>test.cpp</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;Arduino.h&gt;
</span>
<span class="kt">int</span> <span class="n">ledPin</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// GPIO4
</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">pinMode</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"LED ON</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"LED OFF</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>Compile it.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>g++ -lpiduino test.cpp -o test
</code></pre>
</div>

<p>Now connect an LED with its proper resistor (e.g. 220 ohms) to RPi GPIO4.
You can check which pin is GPIO4 in your board in the <a href="/PiDuino_Library/RPi_Pinout.html">RPi Pinout</a> tab.</p>

<p><img src="images/LED_Example.png" alt="LED-Example" class="center-image" /></p>

<p>Run your program.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./test
</code></pre>
</div>

<p>Enjoy!!.</p>

<p>See the <a href="/PiDuino_Library/Reference.html">Reference</a> tab to see all the functions ported.</p>

<hr />

<p><strong>Optional</strong></p>

<ul>
  <li>If you want to compile an .ino file you can do it like below and use either g++ or gcc.</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>g++ -lpiduino -x c++ test.ino -o test 
</code></pre>
</div>

<ul>
  <li>If you want to include main() in your code you can call “piDuino.h”. piDuino.h has already all the headers of the Piduino library included so you don’t need to include Wire.h or SPI.h like as if you use Arduino.h.</li>
</ul>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include "piDuino.h"
</span>
<span class="kt">int</span> <span class="n">ledPin</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// GPIO4
</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">pinMode</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"LED ON</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"LED OFF</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
	<span class="n">setup</span><span class="p">();</span>
	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">loop</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li>When the program exits this library will turn off and set as INPUT all pins that were configured using <a href="/PiDuino_Library/function/2000/02/02/pinMode.html">pinMode(pin, mode)</a>. This to prevent leaving LEDs or Motors running if a program crashes or not behaves well. If you want to do something at exit or prevent pins to be turned off then you can assign an exit function to the variable <em>ARDUINO_EXIT_FUNC</em>. By adding <strong>exit(1)</strong> in your exit function the configured pins will not be turned off.</li>
</ul>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include "Arduino.h"
</span>
<span class="c1">// Add an LED to the output pin then run this program
// and enter Ctr-C to see how the LED turns off auto-magically
</span>
<span class="kt">int</span> <span class="n">GPIO_OUTPUT</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">myExit</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// Commands to be executed when the program exits. 
</span>   <span class="n">printf</span><span class="p">(</span><span class="s">"My exit commands</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
   <span class="c1">// Uncommenting exit(1) will prevent pins to be turned off at exit. 
</span>   <span class="c1">// exit(1);
</span>
<span class="kt">void</span> <span class="n">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">ARDUINO_EXIT_FUNC</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">myExit</span><span class="p">;</span>
   <span class="n">pinMode</span><span class="p">(</span><span class="n">GPIO_OUTPUT</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
   <span class="n">digitalWrite</span><span class="p">(</span><span class="n">GPIO_OUTPUT</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li>If you want to check that the SPI, I2C drivers are enabled use the command below.
Note that the I2C number may be different depending on your RPi board version.</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>ls /dev/ | grep 'i2c-\|spidev\|ttyAMA0'
</code></pre>
</div>

<p>The output should be something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>i2c-1
spidev0.0
spidev0.1
ttyAMA0
</code></pre>
</div>

<p><strong>Donate</strong></p>

<p class="center-image">Your donations will help me continue improving this library.</p>

<p class="center-image"><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=XV85PF2AAESFJ&amp;lc=US&amp;item_name=Piduino%20Library&amp;currency_code=USD&amp;bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted"><img src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" alt="" /></a></p>

<p class="center-image">░░░░░░░░░▄░░░░░░░░░░░░░░▄<br />
░░░░░░░░▌▒█░░░░░░░░░░░▄▀▒▌<br />
░░░░░░░░▌▒▒█░░░░░░░░▄▀▒▒▒▐<br />
░░░░░░░▐▄▀▒▒▀▀▀▀▄▄▄▀▒▒▒▒▒▐<br />
░░░░░▄▄▀▒░▒▒▒▒▒▒▒▒▒█▒▒▄█▒▐<br />
░░░▄▀▒▒▒░░░▒▒▒░░░▒▒▒▀██▀▒▌<br />
░░▐▒▒▒▄▄▒▒▒▒░░░▒▒▒▒▒▒▒▀▄▒▒▌<br />
░░▌░░▌█▀▒▒▒▒▒▄▀█▄▒▒▒▒▒▒▒█▒▐<br />
░▐░░░▒▒▒▒▒▒▒▒▌██▀▒▒░░░▒▒▒▀▄▌<br />
░▌░▒▄██▄▒▒▒▒▒▒▒▒▒░░░░░░▒▒▒▒▌<br />
▌▒▀▐▄█▄█▌▄░▀▒▒░░░░░░░░░░▒▒▒▐<br />
▐▒▒▐▀▐▀▒░▄▄▒▄▒▒▒▒▒▒░▒░▒░▒▒▒▒▌<br />
▐▒▒▒▀▀▄▄▒▒▒▄▒▒▒▒▒▒▒▒░▒░▒░▒▒▐<br />
░▌▒▒▒▒▒▒▀▀▀▒▒▒▒▒▒░▒░▒░▒░▒▒▒▌<br />
░▐▒▒▒▒▒▒▒▒▒▒▒▒▒▒░▒░▒░▒▒▄▒▒▐<br />
░░▀▄▒▒▒▒▒▒▒▒▒▒▒░▒░▒░▒▄▒▒▒▒▌<br />
░░░░▀▄▒▒▒▒▒▒▒▒▒▒▄▄▄▀▒▒▒▒▄▀<br />
░░░░░░▀▄▄▄▄▄▄▀▀▀▒▒▒▒▒▄▄▀<br />
░░░░░░░░░▒▒▒▒▒▒▒▒▒▒▀</p>

<p class="center-image">Thank you!.</p>


        </div>
        <p>By Jorge Garza , Updated on: 
        <time datetime="2016-08-05T00:00:00-07:00">Aug 5, 2016</time>
        </p>
      </article>
      <hr>
      <div class="fb-comments" data-href="http://nvsl.github.io/PiDuino_Library/" data-numposts="5"></div>
    


    </article>
    <footer>
      <span><a href="https://github.com/NVSL/PiDuino_Library">Github</a></span>
      <span><a href="https://github.com/NVSL/PiDuino_Library"><i class="fa fa-github-square"></i></a></span>
      <span>&copy; 2016</span>
    </footer>
  </body>
</html>
